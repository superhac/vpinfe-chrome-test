# .github/workflows/build.yml
name: Build Chromium App

on:
  push:
    branches: [ master ]
  pull_request:
    branches: [ master ]

jobs:
  build:
    runs-on: ubuntu-latest

    steps:
      # 1. Checkout the repo
      - name: Checkout repository
        uses: actions/checkout@v3

      # 2. Set up Python 3.14
      - name: Set up Python
        uses: actions/setup-python@v4
        with:
          python-version: '3.14'

      # 3. Install Python dependencies
      - name: Install dependencies
        run: |
          python -m pip install --upgrade pip
          pip install screeninfo pyinstaller

      # 4. Create directories for Chromium
      - name: Create directories for Chromium
        run: mkdir -p chromium/linux chromium/windows chromium/mac

      # 5. Download Linux Chromium
      - name: Download Linux Chromium
        run: |
          wget -O chromium/linux/chrome.zip "https://www.googleapis.com/download/storage/v1/b/chromium-browser-snapshots/o/Linux_x64%2F1582450%2Fchrome-linux.zip?alt=media"
          unzip -q chromium/linux/chrome.zip -d chromium/linux

      # 6. Download Windows Chromium
      - name: Download Windows Chromium
        run: |
          wget -O chromium/windows/chrome.zip "https://www.googleapis.com/download/storage/v1/b/chromium-browser-snapshots/o/Win_x64%2F1582426%2Fchrome-win.zip?alt=media"
          unzip -q chromium/windows/chrome.zip -d chromium/windows

      # 7. Download Mac Chromium
      - name: Download Mac Chromium
        run: |
          wget -O chromium/mac/chrome.zip "https://www.googleapis.com/download/storage/v1/b/chromium-browser-snapshots/o/Mac%2F1582441%2Fchrome-mac.zip?alt=media"
          unzip -q chromium/mac/chrome.zip -d chromium/mac

      # 8. Build the app with PyInstaller
      - name: Build app with PyInstaller
        run: |
          pyinstaller --onefile your_main_script.py
          # For GUI apps, use: pyinstaller --onefile --noconsole your_main_script.py

      # 9. Upload the built executable(s) as artifacts
      - name: Upload build artifacts
        uses: actions/upload-artifact@v4
        with:
          name: chromium-app
          path: dist/
